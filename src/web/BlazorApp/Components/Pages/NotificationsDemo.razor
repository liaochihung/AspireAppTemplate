@page "/notifications-demo"
@using AspireAppTemplate.Web.Infrastructure.Services
@using AspireAppTemplate.Web.Infrastructure.Extensions
@inject ISnackbar Snackbar
@inject NotificationService NotificationService
@using Microsoft.Extensions.Localization
@using AspireAppTemplate.Shared.Resources
@inject IStringLocalizer<SharedResource> Loc

<PageTitle>@Loc["NotificationsDemo_Title"]</PageTitle>

<MudText Typo="Typo.h4" Class="mb-4">@Loc["NotificationsDemo_PageTitle"]</MudText>

<MudPaper Class="pa-4 mb-4">
    <MudText Typo="Typo.h6" Class="mb-3">@Loc["NotificationsDemo_TestIntegration"]</MudText>
    
    <MudStack Row="true" Spacing="2">
        <MudButton Variant="Variant.Filled" Color="Color.Info" OnClick="@(() => ShowNotification(Severity.Info))">
            @Loc["NotificationsDemo_InfoButton"]
        </MudButton>
        <MudButton Variant="Variant.Filled" Color="Color.Success" OnClick="@(() => ShowNotification(Severity.Success))">
            @Loc["NotificationsDemo_SuccessButton"]
        </MudButton>
        <MudButton Variant="Variant.Filled" Color="Color.Warning" OnClick="@(() => ShowNotification(Severity.Warning))">
            @Loc["NotificationsDemo_WarningButton"]
        </MudButton>
        <MudButton Variant="Variant.Filled" Color="Color.Error" OnClick="@(() => ShowNotification(Severity.Error))">
            @Loc["NotificationsDemo_ErrorButton"]
        </MudButton>
    </MudStack>
</MudPaper>

<MudPaper Class="pa-4">
    <MudText Typo="Typo.h6" Class="mb-3">@Loc["NotificationsDemo_Instructions"]</MudText>
    <div class="ml-4">
        <div class="d-flex align-start mb-2">
            <MudIcon Icon="@Icons.Material.Filled.Info" Color="Color.Info" Class="mr-2" />
            <MudText><strong>Info / Success</strong>：@Loc["NotificationsDemo_InfoDesc"]</MudText>
        </div>
        <div class="d-flex align-start mb-2">
            <MudIcon Icon="@Icons.Material.Filled.Warning" Color="Color.Warning" Class="mr-2" />
            <MudText><strong>Warning</strong>：@Loc["NotificationsDemo_WarningDesc"]</MudText>
        </div>
        <div class="d-flex align-start mb-2">
            <MudIcon Icon="@Icons.Material.Filled.Error" Color="Color.Error" Class="mr-2" />
            <MudText><strong>Error</strong>：@Loc["NotificationsDemo_ErrorDesc"]</MudText>
        </div>
    </div>
</MudPaper>

@code {
    private int _counter = 0;

    private async Task ShowNotification(Severity severity)
    {
        _counter++;
        var message = Loc["NotificationsDemo_TestMessage", severity, _counter];
        
        // 使用擴充方法自動整合
        await Snackbar.AddWithNotificationAsync(NotificationService, message, severity);
    }
}
